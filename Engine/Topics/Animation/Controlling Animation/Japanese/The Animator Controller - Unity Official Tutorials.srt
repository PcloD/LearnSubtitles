1
00:00:00,414 --> 00:00:02,472
アニメーターコントローラーは 1 個以上の

2
00:00:02,472 --> 00:00:04,472
ステートマシンを含み  再生中のアニメーションを

3
00:00:04,472 --> 00:00:06,472
制御します

4
00:00:07,303 --> 00:00:09,806
各ステートはパラメーター制御されていて

5
00:00:09,806 --> 00:00:12,568
値はスクリプトから取得されます

6
00:00:13,549 --> 00:00:15,879
アニメーターコントローラーを作成するには

7
00:00:15,879 --> 00:00:18,569
Project ビューの Create メニューから

8
00:00:18,569 --> 00:00:21,439
Animator Controller を選択します

9
00:00:22,271 --> 00:00:24,743
また Asset ビューの何もないところを右クリックして

10
00:00:24,743 --> 00:00:26,895
Create > Animator Controller と選択する

11
00:00:26,895 --> 00:00:29,268
方法でも作成できます

12
00:00:30,445 --> 00:00:32,585
アニメーターコントローラーは

13
00:00:32,585 --> 00:00:34,585
Animator ウィンドウで管理されます

14
00:00:34,585 --> 00:00:37,209
Animator ウィンドウを開くには

15
00:00:37,209 --> 00:00:39,209
Window > Animator の順にクリックするか

16
00:00:39,709 --> 00:00:43,709
アニメーターコントローラーアセットをダブルクリックします

17
00:00:44,306 --> 00:00:47,132
このウィンドウはサイズ変更・ドッキング可能なので

18
00:00:47,132 --> 00:00:48,966
ワークフローに合わせて好みの場所に

19
00:00:48,966 --> 00:00:50,966
配置することができます

20
00:00:52,336 --> 00:00:54,267
パラメーターを作成するには

21
00:00:54,267 --> 00:00:57,126
Animator ウィンドウ左下にある

22
00:00:57,126 --> 00:01:00,807
Parameters の隣に表示されている + アイコンをクリックします

23
00:01:01,197 --> 00:01:04,066
パラメーターには Float / Int 

24
00:01:04,066 --> 00:01:06,066
Bool / Trigger があります

25
00:01:06,787 --> 00:01:08,933
パラメーターの用途は通常アニメーションの

26
00:01:08,933 --> 00:01:11,882
品質制御と遷移決定条件の指定です

27
00:01:13,004 --> 00:01:15,492
たとえばヒューマノイドの移動アニメーションを

28
00:01:15,492 --> 00:01:17,687
作る場合には float パラメーターでスピードを

29
00:01:17,687 --> 00:01:20,442
制御するのが一般的な方法です

30
00:01:21,011 --> 00:01:23,305
そしてスピードのパラメーター値が大きくなったら

31
00:01:23,305 --> 00:01:25,208
アニメーターコントローラーがより早い

32
00:01:25,208 --> 00:01:28,182
アニメーションのステートに遷移させたりできます

33
00:01:29,365 --> 00:01:32,000
この「ステート」は 3 種類の方法で作成できます

34
00:01:32,500 --> 00:01:35,207
ひとつめは アニメーションクリップを

35
00:01:35,207 --> 00:01:37,124
Project パネルからAnimator パネルの

36
00:01:37,124 --> 00:01:39,608
空いている場所にドラッグする方法

37
00:01:40,107 --> 00:01:42,596
この場合ステートはドラッグされた

38
00:01:42,596 --> 00:01:44,568
アニメーションクリップの

39
00:01:44,568 --> 00:01:46,129
モーションになります

40
00:01:46,861 --> 00:01:49,064
2 つめの方法はAnimator パネルの空いている

41
00:01:49,064 --> 00:01:51,467
場所を右クリックして

42
00:01:51,467 --> 00:01:53,785
Create State を選択する方法です

43
00:01:54,478 --> 00:01:56,909
この場合は次の 3 種類のオプションがあります

44
00:01:57,365 --> 00:02:00,828
Empty（空）/ From Selected Clip（選択したクリップから）

45
00:02:00,828 --> 00:02:02,828
From New Blend Tree（新しいブレンドツリーから）

46
00:02:03,673 --> 00:02:05,576
ブレンドツリーの詳細については

47
00:02:05,576 --> 00:02:07,800
下記リンク先にあるレッスンをご覧ください

48
00:02:09,278 --> 00:02:11,278
Empty を選んだ場合には単純に 一切モーションを

49
00:02:11,278 --> 00:02:13,054
含まないステートが作成されます

50
00:02:13,054 --> 00:02:15,233
これは他のレイヤーで再生中のアニメーションを

51
00:02:15,233 --> 00:02:18,098
マスクしない点が特に有用です

52
00:02:19,150 --> 00:02:21,538
アニメーションレイヤーの詳細については

53
00:02:21,538 --> 00:02:23,538
下記リンク先にあるレッスンをご覧ください

54
00:02:24,936 --> 00:02:27,558
From Selected Clip（選択したクリップから）を指定した場合は

55
00:02:27,558 --> 00:02:29,280
Project パネルでステートにする

56
00:02:29,280 --> 00:02:31,280
アニメーションを選択状態にしておく

57
00:02:31,280 --> 00:02:33,280
必要があります

58
00:02:35,976 --> 00:02:38,700
三つ目の方法は Animation

59
00:02:38,700 --> 00:02:40,421
ウィンドウでステートを作る

60
00:02:40,421 --> 00:02:41,990
方法です

61
00:02:42,783 --> 00:02:44,992
なお Animation ウィンドウは

62
00:02:44,992 --> 00:02:46,509
Animator ウィンドウとはまったく別のものです

63
00:02:46,912 --> 00:02:48,912
アニメーションを作成すると

64
00:02:48,912 --> 00:02:50,773
対応するアニメーターコントローラーの

65
00:02:50,773 --> 00:02:53,867
ベースレイヤーにステートが

66
00:02:53,867 --> 00:02:56,729
作成されます

67
00:02:57,458 --> 00:02:59,568
Animation ウィンドウについては解説動画が

68
00:02:59,568 --> 00:03:01,568
あります 詳細は下記リンクをご覧ください

69
00:03:02,483 --> 00:03:04,679
レイヤー上に最初に作成されたステートは

70
00:03:04,679 --> 00:03:06,679
自動的にデフォルトのステートになります

71
00:03:06,679 --> 00:03:09,751
デフォルトのステートはオレンジ色で示されます

72
00:03:10,458 --> 00:03:12,680
デフォルトにするステートは

73
00:03:12,680 --> 00:03:14,391
任意のステートを右クリックして

74
00:03:14,391 --> 00:03:18,011
Set As Default（デフォルトに設定）を選ぶことで変更できます

75
00:03:18,870 --> 00:03:21,343
デフォルトのステートは最初に再生される

76
00:03:21,343 --> 00:03:23,343
アニメーションになります

77
00:03:24,009 --> 00:03:26,078
インスペクターパネルでステートを編集するには

78
00:03:26,078 --> 00:03:27,718
ステートをクリックします

79
00:03:28,481 --> 00:03:31,146
最上部ではステートに名前と

80
00:03:31,146 --> 00:03:32,843
タグを付けることができます

81
00:03:33,425 --> 00:03:35,425
特定のステート時にアクションを

82
00:03:35,425 --> 00:03:37,094
実行するときなどにはこの名前とタグで

83
00:03:37,094 --> 00:03:39,094
参照することができます

84
00:03:39,401 --> 00:03:41,401
なので名前やタグは内容を示す

85
00:03:41,401 --> 00:03:43,401
ものを指定しておきましょう

86
00:03:44,232 --> 00:03:46,384
Speed プロパティは通常再生スピードに対して

87
00:03:46,384 --> 00:03:48,245
どの程度の速度でアニメーションを 

88
00:03:48,245 --> 00:03:49,953
再生するかを指定するものです

89
00:03:50,552 --> 00:03:53,270
1 が通常スピードを示します

90
00:03:54,709 --> 00:03:57,031
Motion プロパティではステート固有の

91
00:03:57,031 --> 00:03:59,581
アニメーションクリップを指定できます

92
00:04:00,650 --> 00:04:03,382
Foot IK は

93
00:04:03,382 --> 00:04:05,896
Foot Inverse Kinematics（フット逆運動学）の略です

94
00:04:06,338 --> 00:04:08,226
このオプションをオンにすると

95
00:04:08,226 --> 00:04:10,519
アニメーション中の足の「滑り」を

96
00:04:10,519 --> 00:04:13,253
減少または無くしてくれます

97
00:04:14,676 --> 00:04:16,676
Mirror プロパティはアニメーションの

98
00:04:16,676 --> 00:04:19,035
左右を逆転させます

99
00:04:20,378 --> 00:04:23,226
その下にはこのステートから他のステートへの

100
00:04:23,226 --> 00:04:25,226
遷移（Transition）のリストが表示されます

101
00:04:25,726 --> 00:04:27,892
現時点ではリストは空ですので

102
00:04:27,892 --> 00:04:29,892
ここで作ってみましょう

103
00:04:30,931 --> 00:04:33,704
遷移とはアニメーターコントローラーが

104
00:04:33,704 --> 00:04:36,145
アニメーションクリップ間を滑らかに

105
00:04:36,145 --> 00:04:37,164
つなげるしくみです

106
00:04:37,595 --> 00:04:40,973
遷移のタイミングや方法は指定可能で

107
00:04:40,973 --> 00:04:43,627
高度な制御が行えます

108
00:04:44,730 --> 00:04:47,338
ステート間の遷移を作成するには

109
00:04:47,338 --> 00:04:48,980
まず遷移元のステートを右クリックして 

110
00:04:48,980 --> 00:04:52,889
Make Transition（遷移を作成）を選択します

111
00:04:53,883 --> 00:04:56,035
すると遷移先への矢印が表示され

112
00:04:56,035 --> 00:04:58,035
カーソルに追従してきます

113
00:04:58,715 --> 00:05:01,999
そうしたら遷移先のステートをクリックすれば遷移の完成です

114
00:05:03,507 --> 00:05:05,230
遷移はクリックすることで

115
00:05:05,230 --> 00:05:07,230
インスペクター上で編集可能です

116
00:05:08,310 --> 00:05:10,572
各遷移には Solo と Mute という

117
00:05:10,572 --> 00:05:12,320
オプションがあります

118
00:05:12,989 --> 00:05:15,545
Mute は遷移を無効化するオプションです

119
00:05:16,045 --> 00:05:18,477
Solo の方は同一ステートから来る

120
00:05:18,477 --> 00:05:20,643
すべての遷移を監視し

121
00:05:20,643 --> 00:05:22,989
Solo とマークされていないものを

122
00:05:22,989 --> 00:05:24,989
Mute します

123
00:05:25,945 --> 00:05:28,568
Mute と Solo はステートマシンの

124
00:05:28,568 --> 00:05:31,453
特定の領域だけに特化したデバッグ用ツールですので

125
00:05:32,174 --> 00:05:33,508
リリースビルド内では

126
00:05:33,508 --> 00:05:35,508
無効にしておく必要があります

127
00:05:36,809 --> 00:05:38,809
その下にあるのは

128
00:05:38,809 --> 00:05:40,809
遷移の名前に関するオプションです

129
00:05:41,309 --> 00:05:44,570
そしてさらにその下には Atomic プロパティがあります

130
00:05:45,180 --> 00:05:47,483
Atomic プロパティをオンにすると

131
00:05:47,483 --> 00:05:49,483
その遷移は他の一切の

132
00:05:49,483 --> 00:05:52,553
遷移から干渉できなくなります

133
00:05:53,806 --> 00:05:55,283
続いてこのグラフ  これはアニメーションが

134
00:05:55,283 --> 00:05:57,283
遷移中にどう扱われるかを示します

135
00:05:58,004 --> 00:06:00,004
目盛りは秒数とフレーム数を示します

136
00:06:00,504 --> 00:06:02,504
このグラフには 3 つのマーカーがあり

137
00:06:02,504 --> 00:06:04,047
遷移の開始時と終了時を示すものの他

138
00:06:04,047 --> 00:06:06,785
遷移アニメーションをプレビューする

139
00:06:06,785 --> 00:06:09,334
ための時間指定線があります

140
00:06:10,583 --> 00:06:12,652
開始時マーカーと終了時マーカーの間の領域は

141
00:06:12,652 --> 00:06:14,901
青色で表示されていますが これは

142
00:06:14,901 --> 00:06:16,901
アニメーションの遷移している期間を示します

143
00:06:18,754 --> 00:06:20,908
またグラフのカーブ（曲線）は

144
00:06:20,908 --> 00:06:22,908
どの時点で両足が最も安定しているかを示します

145
00:06:23,864 --> 00:06:26,059
Run（走る）アニメーションのステートでは

146
00:06:26,059 --> 00:06:27,920
カーブが上昇と下降を見せたあと

147
00:06:27,920 --> 00:06:29,547
戻っているのが確認できますね

148
00:06:30,240 --> 00:06:32,157
線が中央にある場合には...

149
00:06:32,157 --> 00:06:34,807
たとえば Idle アニメーションの時には

150
00:06:34,807 --> 00:06:36,807
どちらか一方の足が他方より安定していることはないと読み取れます

151
00:06:38,163 --> 00:06:39,926
滑らかに遷移させるためには

152
00:06:39,926 --> 00:06:41,926
この曲線同士がうまく合うようにしましょう

153
00:06:42,606 --> 00:06:44,606
片足が際立って安定していないのであれば

154
00:06:44,606 --> 00:06:46,606
この点は特に注意を払わなくても大丈夫です

155
00:06:48,239 --> 00:06:49,805
2 つのステートはグラフ上で前後に 

156
00:06:49,805 --> 00:06:51,805
移動させて遷移の

157
00:06:51,805 --> 00:06:53,971
開始点と終了点を

158
00:06:53,971 --> 00:06:55,971
調整することができます

159
00:06:57,175 --> 00:06:59,175
そしてグラフの下には遷移を実行する

160
00:06:59,175 --> 00:07:01,175
Conditions（条件）を指定する

161
00:07:01,175 --> 00:07:02,322
オプションが用意されています

162
00:07:02,946 --> 00:07:04,946
デフォルト設定では遷移には必ず

163
00:07:04,946 --> 00:07:06,946
Exit time（終了時）が設定されます

164
00:07:07,584 --> 00:07:09,334
これはステートのアニメーションが

165
00:07:09,334 --> 00:07:11,949
終了する時間になったら次のステートに

166
00:07:11,949 --> 00:07:14,498
遷移するという意味です

167
00:07:15,830 --> 00:07:18,736
なお条件はパラメーターによって異なります

168
00:07:18,736 --> 00:07:22,191
たとえば Bool パラメーターであれば true か false ですし

169
00:07:22,191 --> 00:07:24,191
float パラメーターであれば定数よりも

170
00:07:24,191 --> 00:07:26,770
greater than（次よりも大きい）または less than（次よりも小さい）といった具合です

171
00:07:27,851 --> 00:07:29,698
なお遷移には必要に応じて複数の条件を

172
00:07:29,698 --> 00:07:30,907
設定できます

173
00:07:31,517 --> 00:07:34,150
複数個指定する場合には + ボタンをクリックしてください

174
00:07:36,086 --> 00:07:37,878
インスペクターの下部には

175
00:07:37,878 --> 00:07:39,712
プレビューウィンドウが表示され

176
00:07:39,712 --> 00:07:41,948
遷移の内容を確認できます

177
00:07:46,811 --> 00:07:49,116
なお  ひとつのステートに複数の遷移を

178
00:07:49,116 --> 00:07:51,587
結びつけることも可能です

179
00:07:52,170 --> 00:07:54,753
通常これは同一の遷移に対して条件を

180
00:07:54,753 --> 00:07:57,089
複数個設定する場合に使われます

181
00:07:57,902 --> 00:07:59,902
たとえば Speed パラメーターがあり

182
00:07:59,902 --> 00:08:02,857
Idle と Run というステートがある場合

183
00:08:03,550 --> 00:08:05,550
Idle から Run への遷移に条件を

184
00:08:05,550 --> 00:08:07,619
つけるとしたら

185
00:08:07,619 --> 00:08:09,619
Speed が 0 でない場合と指定できますが

186
00:08:09,619 --> 00:08:11,884
2 個の遷移を作成して

187
00:08:12,796 --> 00:08:14,479
それぞれの条件を

188
00:08:14,479 --> 00:08:16,479
Speed が greater than（次よりも大きい） 0.1

189
00:08:18,816 --> 00:08:21,653
Speed が less than （次よりも小さい）-0.1 のようにも指定できるわけです

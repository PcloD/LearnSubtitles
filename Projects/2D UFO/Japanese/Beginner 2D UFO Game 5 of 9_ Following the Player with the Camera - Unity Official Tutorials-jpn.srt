1
00:00:03,131 --> 00:00:05,131
このレッスンでは、カメラを移動したり

2
00:00:05,131 --> 00:00:07,131
カメラにプレイヤーを追わせたりします

3
00:00:07,839 --> 00:00:10,138
現在、カメラは固定されています

4
00:00:10,594 --> 00:00:12,684
Camera を Player ゲームオブジェクトに

5
00:00:12,684 --> 00:00:14,475
連携させる必要があります

6
00:00:14,902 --> 00:00:17,321
それを行うには

7
00:00:17,321 --> 00:00:20,199
Camera を Player ゲームオブジェクトの子にします

8
00:00:22,336 --> 00:00:24,336
Hierarchy の Camera を

9
00:00:24,793 --> 00:00:26,793
Player の上にドラッグします

10
00:00:27,470 --> 00:00:30,162
簡単に言えば、親子関係は

11
00:00:30,162 --> 00:00:33,476
一方通行の関係で、子を親に

12
00:00:33,476 --> 00:00:35,150
連携させていると考えられます

13
00:00:35,657 --> 00:00:38,073
もし親が動くと、子も動き

14
00:00:38,073 --> 00:00:40,631
親に対する関係を維持します

15
00:00:41,282 --> 00:00:43,178
一方、子が動いても

16
00:00:43,178 --> 00:00:45,178
親は動きません

17
00:00:45,590 --> 00:00:47,590
Camera を Player の子にするのは

18
00:00:47,590 --> 00:00:49,474
かなり典型的な設定です

19
00:00:49,925 --> 00:00:51,925
プレイヤーをエディターで動かすと

20
00:00:52,808 --> 00:00:55,207
グレイの枠で示されたカメラの視界が

21
00:00:55,207 --> 00:00:57,207
プレイヤーとともに動くのが

22
00:00:57,207 --> 00:00:59,207
わかります

23
00:01:01,047 --> 00:01:02,904
プレイヤーの Rotation の値を変えると

24
00:01:02,904 --> 00:01:04,657
カメラも回転します

25
00:01:04,993 --> 00:01:06,993
プレイモードでテストしてみましょう

26
00:01:09,982 --> 00:01:11,634
プレイモードにし

27
00:01:11,634 --> 00:01:13,634
再生を押すと動きます

28
00:01:15,642 --> 00:01:17,642
UFO が壁にぶつかると

29
00:01:17,642 --> 00:01:20,223
スピンを始め、妙な状態になります

30
00:01:20,865 --> 00:01:22,117
何が起こったのでしょうか

31
00:01:22,556 --> 00:01:25,914
Camera は Player の子なので

32
00:01:26,424 --> 00:01:28,424
カメラそのものは動いていなくても

33
00:01:28,424 --> 00:01:30,609
プレイヤーのゲームオブジェクトと連動します

34
00:01:31,053 --> 00:01:33,529
プレイヤーのゲームオブジェクトが回転すると

35
00:01:33,809 --> 00:01:35,964
カメラの視点もそれと一緒に回転します

36
00:01:36,779 --> 00:01:39,823
これでは、私たちも、オーディエンスも疲れてしまいます

37
00:01:41,028 --> 00:01:43,028
この設定は、このゲームには

38
00:01:43,028 --> 00:01:45,028
適切でないのは明らかです

39
00:01:45,825 --> 00:01:47,825
一般的な設定で、Camera は

40
00:01:47,825 --> 00:01:49,825
Player ゲームオブジェクトの子として

41
00:01:49,825 --> 00:01:51,719
常にその直接の親に対して

42
00:01:52,083 --> 00:01:54,083
相対的な位置をとっています

43
00:01:54,703 --> 00:01:56,519
そして、この位置は

44
00:01:56,519 --> 00:01:58,153
ゲーム内での親の位置であり

45
00:01:58,153 --> 00:02:00,321
子の Transform の値に

46
00:02:00,321 --> 00:02:02,598
修正やオフセットを行います

47
00:02:03,367 --> 00:02:05,367
ここでは

48
00:02:05,367 --> 00:02:06,940
Camera を Player の子にすべきではないので

49
00:02:06,940 --> 00:02:09,273
Hierarchy で Camera をPlayer の上にドラッグして

50
00:02:09,273 --> 00:02:11,273
切り離します

51
00:02:12,306 --> 00:02:14,306
私たちが使うオフセット値は

52
00:02:14,306 --> 00:02:16,716
Player ゲームオブジェクトと camera の

53
00:02:16,716 --> 00:02:18,429
差です

54
00:02:19,218 --> 00:02:21,218
ここでは、子としてではなくスクリプトで

55
00:02:21,218 --> 00:02:23,424
Camera をPlayer ゲームオブジェクトに

56
00:02:23,963 --> 00:02:26,751
関連づける必要があります

57
00:02:28,287 --> 00:02:30,287
Main camera をハイライトしたままで

58
00:02:30,618 --> 00:02:32,618
Add Component ボタンを使って

59
00:02:32,936 --> 00:02:34,936
新しいスクリプトを加え

60
00:02:35,649 --> 00:02:38,590
スクリプト名を CameraController としましょう

61
00:02:39,891 --> 00:02:41,891
検索フィールドにコンポーネント名を入れ

62
00:02:41,891 --> 00:02:44,305
見つからないときは

63
00:02:44,704 --> 00:02:47,700
New Script ボタンが表示されます

64
00:02:48,372 --> 00:02:50,372
これでスクリプトを手早く作成できます

65
00:02:50,372 --> 00:02:52,975
名前を入力して 

66
00:02:53,254 --> 00:02:55,254
New Script ボタンをクリックするだけです

67
00:02:56,799 --> 00:02:58,868
Create and Add をクリックするか

68
00:02:58,868 --> 00:03:00,977
エンターキーを押して

69
00:03:00,977 --> 00:03:03,473
選択を確定します

70
00:03:04,817 --> 00:03:06,546
以前にも見たように

71
00:03:06,546 --> 00:03:08,546
このようにスクリプトを作成すると

72
00:03:08,546 --> 00:03:10,546
Project ビューのルートか

73
00:03:10,546 --> 00:03:12,546
最上レベルに作成されます

74
00:03:13,815 --> 00:03:15,815
CameraController を

75
00:03:15,815 --> 00:03:17,815
Script フォルダーに入れてから

76
00:03:17,815 --> 00:03:19,318
開いて編集しましょう

77
00:03:21,560 --> 00:03:23,560
ここでは、2 つの変数が必要です

78
00:03:23,560 --> 00:03:26,779
Player を参照するパブリックなゲームオブジェクトと

79
00:03:27,467 --> 00:03:29,532
オフセット値を記憶する

80
00:03:29,891 --> 00:03:31,891
プライベートの vector3 です

81
00:03:32,584 --> 00:03:36,572
public GameObject player と入力します

82
00:03:40,768 --> 00:03:45,416
次に private vector3 offset 

83
00:03:47,247 --> 00:03:49,247
Offset はプライベートです

84
00:03:49,247 --> 00:03:51,619
なぜなら、このスクリプト内で

85
00:03:51,619 --> 00:03:52,746
値を設定するからです

86
00:03:53,358 --> 00:03:55,358
オフセット値は

87
00:03:55,358 --> 00:03:57,416
Camera の現在のTransform 位置から

88
00:03:57,416 --> 00:03:59,416
Player の Transform 位置を

89
00:03:59,416 --> 00:04:01,416
差し引き

90
00:04:01,416 --> 00:04:03,416
2 者の違いを

91
00:04:03,416 --> 00:04:05,416
求めます

92
00:04:06,417 --> 00:04:08,850
これがoffset 値になります

93
00:04:09,544 --> 00:04:11,544
それでまず offset を

94
00:04:11,544 --> 00:04:13,544
Transform 位置から

95
00:04:13,544 --> 00:04:15,544
Player の Transform 位置を

96
00:04:15,544 --> 00:04:18,700
差し引いた値にします

97
00:04:20,619 --> 00:04:30,658
Type offset = transform.position - player.transform.position　と入力します

98
00:04:32,193 --> 00:04:33,940
このように入力するとき

99
00:04:33,940 --> 00:04:35,940
この transform はスクリプトが

100
00:04:35,940 --> 00:04:37,940
アタッチされているゲームオブジェクトの

101
00:04:37,940 --> 00:04:39,940
Transform を参照しています

102
00:04:39,940 --> 00:04:41,940
覚えておくといいのは

103
00:04:41,940 --> 00:04:43,940
このスクリプトが camera コンポーネントと同じゲームオブジェクトに

104
00:04:43,940 --> 00:04:45,940
アタッチされているということです

105
00:04:45,940 --> 00:04:47,940
このスクリプトと camera コンポーネントは

106
00:04:47,940 --> 00:04:50,179
同じオブジェクトにアタッチされているので

107
00:04:50,179 --> 00:04:52,179
transform.position は

108
00:04:52,179 --> 00:04:53,485
Camera の Transform の位置を参照します

109
00:04:53,485 --> 00:04:55,485
Update で、

110
00:04:55,485 --> 00:04:57,485
Camera のTransform 位置を

111
00:04:58,012 --> 00:05:00,166
Player の Transform 位置プラス

112
00:05:00,464 --> 00:05:01,760
Offset に設定します

113
00:05:02,227 --> 00:05:04,304
Update 内に置くため

114
00:05:04,657 --> 00:05:06,657
これはすべてのフレームで起こります

115
00:05:09,267 --> 00:05:20,418
transform.position = player.transform.position + offset　と入力します

116
00:05:21,177 --> 00:05:23,177
つまり、キーボードで制御して 

117
00:05:23,177 --> 00:05:25,177
Player を移動するので

118
00:05:25,786 --> 00:05:27,786
各フレームで、カメラに写るものを

119
00:05:27,786 --> 00:05:29,786
表示する前に

120
00:05:29,786 --> 00:05:31,786
カメラはまるでそのオブジェクトの子であるかのように

121
00:05:31,786 --> 00:05:34,590
プレイヤーと並んで

122
00:05:35,327 --> 00:05:37,327
新しい位置へ移動します

123
00:05:37,327 --> 00:05:39,327
ただし、ゲームボードの周りを

124
00:05:39,327 --> 00:05:41,327
親オブジェクトがするように

125
00:05:41,327 --> 00:05:43,327
スピンしたりはしませんが

126
00:05:43,708 --> 00:05:47,719
ただし、Update はこのコードに最適ではありません

127
00:05:48,594 --> 00:05:50,594
確かに Update は

128
00:05:50,594 --> 00:05:52,594
すべてのフレームで実行されるため

129
00:05:52,594 --> 00:05:54,594
Update でPlayer の

130
00:05:54,594 --> 00:05:56,594
ゲームオブジェクトの位置を追跡し

131
00:05:56,594 --> 00:05:58,594
カメラの位置を設定できます

132
00:05:59,094 --> 00:06:01,693
ただし、フォローパン、

133
00:06:01,693 --> 00:06:04,266
プロシージャルアニメーション、最終ステートの取得には

134
00:06:04,266 --> 00:06:08,331
LateUpdate が最適です

135
00:06:09,053 --> 00:06:12,584
Update を LateUpdate に変えてみましょう

136
00:06:14,063 --> 00:06:16,063
LateUpdate はUpdate と同じように

137
00:06:16,063 --> 00:06:17,586
すべてのフレームで実行されますが、

138
00:06:17,586 --> 00:06:19,586
Update ですべてが処理された後に

139
00:06:19,586 --> 00:06:22,624
はじめて実行されます

140
00:06:23,403 --> 00:06:25,403
そのため、カメラの位置を設定するときに

141
00:06:25,403 --> 00:06:28,075
確実にPlayer はそのフレームで

142
00:06:28,075 --> 00:06:30,075
すでに作動しています。

143
00:06:31,011 --> 00:06:33,775
では、テストしてみましょう。スクリプトを保存して

144
00:06:33,775 --> 00:06:35,775
Unity に戻ります

145
00:06:38,017 --> 00:06:40,017
最初にPlayer ゲームオブジェクトへの参照を

146
00:06:40,017 --> 00:06:42,017
作成する必要があります

147
00:06:42,017 --> 00:06:44,017
Player ゲームオブジェクトをドラッグして

148
00:06:44,017 --> 00:06:46,017
CameraController コンポーネントの 

149
00:06:46,017 --> 00:06:48,017
Player スロットに移動します

150
00:06:49,800 --> 00:06:51,800
プレイモードにします

151
00:06:52,938 --> 00:06:54,938
思った通りのビヘイビアになりました

152
00:06:55,954 --> 00:06:57,954
カメラは、衝突しても

153
00:06:57,954 --> 00:07:00,698
スピンすることなく UFO を追います

154
00:07:01,784 --> 00:07:03,784
次回は、このゲームのアイテムを

155
00:07:03,784 --> 00:07:06,252
作成し配置して

156
00:07:06,252 --> 00:07:09,177
基本のプレイエリアを終了させます

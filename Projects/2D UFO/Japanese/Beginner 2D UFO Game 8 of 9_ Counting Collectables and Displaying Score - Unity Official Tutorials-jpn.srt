1
00:00:04,008 --> 00:00:06,487
さて、数えたアイテムの値を保存する

2
00:00:06,487 --> 00:00:09,754
ツールが必要です

3
00:00:10,392 --> 00:00:12,392
さらに、その値に

4
00:00:12,392 --> 00:00:14,392
取得して数えた値を加算する

5
00:00:14,392 --> 00:00:16,060
ツールも必要です

6
00:00:16,739 --> 00:00:18,739
このツールを

7
00:00:18,739 --> 00:00:20,739
PlayerController スクリプトに加えましょう

8
00:00:21,696 --> 00:00:23,696
Player ゲームオブジェクトを選択し

9
00:00:24,362 --> 00:00:27,845
PlayerController スクリプトを開いて編集します

10
00:00:31,909 --> 00:00:34,602
収集したアイテムの総数を記憶する

11
00:00:35,074 --> 00:00:37,074
プライベートの変数を

12
00:00:37,074 --> 00:00:39,074
加えましょう

13
00:00:39,767 --> 00:00:41,767
この変数は int です

14
00:00:41,767 --> 00:00:43,767
総数は整数で

15
00:00:43,767 --> 00:00:46,113
オブジェクトを部分的に収集することはないからです

16
00:00:46,862 --> 00:00:48,862
それは、Count という名にしましょう

17
00:00:50,346 --> 00:00:54,198
private int count;　と入力します

18
00:00:55,324 --> 00:00:57,324
このゲームでは、最初に

19
00:00:57,324 --> 00:00:59,726
総数が 0 から始まります

20
00:01:00,461 --> 00:01:02,461
それから、新たにオブジェクトを

21
00:01:02,461 --> 00:01:04,797
収集するごとに、1 ずつ

22
00:01:04,797 --> 00:01:06,797
総数を増加させていきます

23
00:01:08,753 --> 00:01:11,325
count の値を 0 に設定します

24
00:01:12,237 --> 00:01:14,237
この変数はプライベートなので

25
00:01:14,237 --> 00:01:16,237
Inspector では

26
00:01:16,237 --> 00:01:18,237
アクセスできません

27
00:01:18,237 --> 00:01:20,237
この変数を使用するのは

28
00:01:20,237 --> 00:01:23,132
スクリプトからに限られます

29
00:01:23,575 --> 00:01:25,575
そういうわけで、初期値を

30
00:01:25,575 --> 00:01:28,216
スクリプトで設定します

31
00:01:28,882 --> 00:01:30,882
count の初期値を設定するのに

32
00:01:30,882 --> 00:01:32,882
いくつか方法がありますが

33
00:01:32,882 --> 00:01:35,441
ここでは Start 関数を使います

34
00:01:35,885 --> 00:01:38,245
Start 関数内で

35
00:01:38,245 --> 00:01:40,245
count を 0 にします

36
00:01:41,826 --> 00:01:44,579
count = 0 と入力します

37
00:01:45,865 --> 00:01:47,865
次に、アイテムのゲームオブジェクトを収集したときに

38
00:01:47,865 --> 00:01:50,690
総数を増加する必要があります

39
00:01:51,550 --> 00:01:53,550
other ゲームオブジェクトのタグが

40
00:01:53,550 --> 00:01:56,299
Pickup ならば

41
00:01:56,299 --> 00:01:58,299
onTriggerEnter2D で

42
00:01:58,299 --> 00:02:00,299
そのオブジェクトを取得します

43
00:02:00,757 --> 00:02:03,384
それで、ここに数量計算のコードを加えます

44
00:02:04,077 --> 00:02:06,077
other ゲームオブジェクトの

45
00:02:06,077 --> 00:02:08,077
アクティブ状態を　

46
00:02:08,077 --> 00:02:10,077
false に設定した後

47
00:02:10,077 --> 00:02:12,077
count の更新後の値は

48
00:02:12,077 --> 00:02:14,601
古い値プラス 1 になります

49
00:02:16,168 --> 00:02:21,999
count = count + 1; と入力します

50
00:02:23,955 --> 00:02:25,955
Unity のコードで

51
00:02:25,955 --> 00:02:27,955
値を合計、増加する方法は

52
00:02:27,955 --> 00:02:29,955
他にもありますが

53
00:02:29,955 --> 00:02:32,581
この方法は簡単に理解できるので

54
00:02:32,581 --> 00:02:34,860
ここでは、この方法を使用します

55
00:02:35,595 --> 00:02:38,287
スクリプトを保存して Unity に戻りましょう

56
00:02:42,269 --> 00:02:44,269
これで、総数を保管して

57
00:02:44,269 --> 00:02:46,269
増加することができますが

58
00:02:46,269 --> 00:02:48,269
それを表示する方法がありません

59
00:02:48,269 --> 00:02:50,269
それに、ゲームが終了したときに

60
00:02:50,269 --> 00:02:52,269
メッセージを表示できたら良いですね

61
00:02:53,309 --> 00:02:55,309
テキストを表示するには

62
00:02:55,309 --> 00:02:57,309
Unity のユーザーインターフェイスか

63
00:02:57,309 --> 00:02:59,544
UI ツールセットを使います

64
00:03:00,238 --> 00:03:02,238
最初に Hierarchy の Create メニューから

65
00:03:02,238 --> 00:03:04,238
新規の UI Text エレメントを

66
00:03:04,238 --> 00:03:07,035
作成しましょう

67
00:03:13,068 --> 00:03:15,068
自分たちが期待した以上のものが手に入ったようです

68
00:03:15,456 --> 00:03:17,456
UI Text エレメントだけでなく

69
00:03:17,456 --> 00:03:19,456
親の Canvas エレメントと

70
00:03:19,456 --> 00:03:21,804
EventSystem ゲームオブジェクトも

71
00:03:21,804 --> 00:03:25,105
作成されました

72
00:03:26,076 --> 00:03:28,076
これらはすべて

73
00:03:28,076 --> 00:03:30,076
UI ツールセットに必要です

74
00:03:30,783 --> 00:03:32,783
これらの追加物について

75
00:03:32,783 --> 00:03:35,022
最も重要なことは

76
00:03:35,022 --> 00:03:37,022
正しく作動するには

77
00:03:37,022 --> 00:03:39,022
すべての UI エレメントは 

78
00:03:39,022 --> 00:03:41,022
Canvas の子である必要がある、ということです

79
00:03:41,618 --> 00:03:44,324
UI ツールに関する詳細は

80
00:03:44,324 --> 00:03:47,764
canvas と EventSystem を含めて

81
00:03:47,764 --> 00:03:50,157
下の情報のリンクをご覧ください

82
00:03:51,401 --> 00:03:53,996
Text エレメントを CountText に

83
00:03:53,996 --> 00:03:55,996
名称変更しましょう

84
00:04:00,254 --> 00:04:02,254
CountText をハイライトしたままで

85
00:04:03,045 --> 00:04:05,547
カーソルを Scene ビューに置き

86
00:04:05,547 --> 00:04:07,950
F キーを押してフレームが選択された状態にします

87
00:04:09,420 --> 00:04:11,420
キャンバス全体から見た

88
00:04:11,975 --> 00:04:13,975
テキストの配置を見るために

89
00:04:13,975 --> 00:04:15,975
ズームアウトしましょう

90
00:04:17,639 --> 00:04:19,639
何かの理由で中央に表示されない場合は

91
00:04:19,639 --> 00:04:21,639
コンテキスト依存のギアメニューで

92
00:04:21,639 --> 00:04:23,639
Rect Transform を

93
00:04:23,639 --> 00:04:26,209
リセットします

94
00:04:28,373 --> 00:04:30,373
テキストが中央に配置されたところで

95
00:04:30,373 --> 00:04:31,846
少しカスタマイズしましょう

96
00:04:31,846 --> 00:04:33,846
デフォルトのテキストは少し暗いですね

97
00:04:33,846 --> 00:04:35,846
テキストを黄色にしましょう

98
00:04:35,846 --> 00:04:37,846
そうすれば見やすいですから

99
00:04:38,276 --> 00:04:40,276
Color をクリックして

100
00:04:42,870 --> 00:04:44,870
カラーピッカーで 

101
00:04:44,870 --> 00:04:47,385
Red 値を 225

102
00:04:47,385 --> 00:04:49,385
Green 値を 225

103
00:04:49,385 --> 00:04:51,385
Blue 値を 0 にします

104
00:04:52,092 --> 00:04:54,092
クリックしてドラッグするか

105
00:04:54,092 --> 00:04:56,520
数字を入力して設定します

106
00:04:57,158 --> 00:04:58,951
カラーピッカーを閉じます

107
00:04:58,951 --> 00:05:00,951
プレースホルダーのテキストを加えましょう

108
00:05:00,951 --> 00:05:02,951
文字列 New Text を 

109
00:05:02,951 --> 00:05:04,951
Count Text に置き換えます

110
00:05:06,061 --> 00:05:08,061
現在、Text エレメントは

111
00:05:08,061 --> 00:05:10,061
画面の中央にあります

112
00:05:10,061 --> 00:05:12,061
なぜなら、親、つまりここでは

113
00:05:12,061 --> 00:05:14,061
キャンバスの中央に

114
00:05:14,061 --> 00:05:16,061
固定されているからです

115
00:05:16,061 --> 00:05:18,061
覚えておくといいですが

116
00:05:18,061 --> 00:05:20,531
UI エレメントのTransform コンポーネントは

117
00:05:20,531 --> 00:05:22,531
Unity の他のゲームオブジェクトの

118
00:05:22,531 --> 00:05:24,531
それとは異なります

119
00:05:25,100 --> 00:05:27,100
UI エレメントでは

120
00:05:27,100 --> 00:05:29,100
標準の Transform は

121
00:05:29,100 --> 00:05:31,100
アンカーや配置をはじめとした

122
00:05:31,710 --> 00:05:33,710
多様な UI システムに必要な

123
00:05:33,710 --> 00:05:35,710
多くの特殊性能を考慮した

124
00:05:35,710 --> 00:05:39,103
Rect Transform に

125
00:05:39,103 --> 00:05:42,199
置き換えられています

126
00:05:43,114 --> 00:05:45,765
Rect Transform に関する詳しい情報は

127
00:05:45,765 --> 00:05:47,765
下のリンクをご覧ください

128
00:05:49,138 --> 00:05:51,138
CountText エレメントを左上に移動する

129
00:05:51,138 --> 00:05:53,138
最も簡単な方法の一つは

130
00:05:53,138 --> 00:05:55,138
キャンバスの中央よりむしろ

131
00:05:55,138 --> 00:05:58,069
キャンバスの左上の角に

132
00:05:58,069 --> 00:06:00,069
アンカーすることです

133
00:06:01,262 --> 00:06:03,262
このテキストエレメントを再度アンカーするときに

134
00:06:03,262 --> 00:06:05,262
ピボットと

135
00:06:05,262 --> 00:06:07,262
新しいアンカーに基づく位置も

136
00:06:07,262 --> 00:06:10,255
設定します

137
00:06:10,907 --> 00:06:12,907
このためには

138
00:06:12,907 --> 00:06:15,172
現在のAnchor プリセットを表示している

139
00:06:15,172 --> 00:06:17,172
ボタンをクリックして 

140
00:06:17,172 --> 00:06:19,172
Anchors Presets メニューを開いてください

141
00:06:20,226 --> 00:06:24,256
Mac では Shift と Option キーを

142
00:06:24,256 --> 00:06:28,274
Windows では Shift と Alt キーを押して

143
00:06:28,274 --> 00:06:33,066
左上のプリセットを選びクリックします

144
00:06:35,049 --> 00:06:36,579
完了です

145
00:06:36,579 --> 00:06:38,274
これで、ゲームビューの角に

146
00:06:38,274 --> 00:06:40,274
移動しました

147
00:06:40,274 --> 00:06:42,274
テキストと画面の端の間に

148
00:06:42,274 --> 00:06:44,567
少し隙間を作りましょう

149
00:06:45,508 --> 00:06:47,902
キャンバスの左上の角にアンカーしたので

150
00:06:47,902 --> 00:06:49,902
同様に、ピボットも左上の角に

151
00:06:49,902 --> 00:06:53,084
設定しました

152
00:06:53,570 --> 00:06:55,763
テキストに少し隙間を作る

153
00:06:55,763 --> 00:06:57,763
もっとも簡単な方法は 

154
00:06:57,763 --> 00:07:00,303
Rect Transform の 

155
00:07:00,303 --> 00:07:02,303
Pos X と Y の値を

156
00:07:02,303 --> 00:07:04,303
変えることです

157
00:07:05,274 --> 00:07:08,546
この場合、X 位置を 10

158
00:07:08,546 --> 00:07:11,288
Y 位置を -10 にすると

159
00:07:11,288 --> 00:07:13,288
良いようです

160
00:07:14,814 --> 00:07:16,814
これで少し隙間ができました

161
00:07:16,814 --> 00:07:19,552
まだ、上すぎて正しい位置ではありませんが

162
00:07:21,979 --> 00:07:23,979
さて、総数の値を表示するために

163
00:07:23,979 --> 00:07:25,979
UI Text エレメントを

164
00:07:25,979 --> 00:07:28,818
設定しましょう

165
00:07:30,122 --> 00:07:32,122
PlayerController スクリプトを開いて

166
00:07:32,122 --> 00:07:34,499
編集することから始めましょう

167
00:07:40,086 --> 00:07:42,086
UI エレメントに関するものをコーディングする前に

168
00:07:42,086 --> 00:07:44,086
スクリプトにUI エレメントについて

169
00:07:44,086 --> 00:07:46,086
説明する必要があります

170
00:07:46,086 --> 00:07:48,086
UI ツールセットについての詳細は

171
00:07:48,086 --> 00:07:50,086
名前空間と呼ばれるものに

172
00:07:50,086 --> 00:07:52,086
記憶されています

173
00:07:52,835 --> 00:07:54,835
UnityEngine と System.Collections を使用しているのと同じように

174
00:07:54,835 --> 00:07:56,835
この名前空間を

175
00:07:56,835 --> 00:08:00,121
使用する必用があります

176
00:08:00,565 --> 00:08:03,358
そうするには、スクリプトの上の方に

177
00:08:03,358 --> 00:08:09,211
using UnityEngine.UI と入力します

178
00:08:09,835 --> 00:08:11,835
これがここにあれば

179
00:08:11,835 --> 00:08:13,394
スクリプティングできます

180
00:08:13,793 --> 00:08:16,112
まず、UI Text ゲームオブジェクトの 

181
00:08:16,112 --> 00:08:19,632
UI Text コンポーネントへの参照を

182
00:08:20,062 --> 00:08:22,062
記憶するために

183
00:08:22,062 --> 00:08:24,062
新しいパブリックのテキスト変数CountText を

184
00:08:24,062 --> 00:08:26,425
作ります

185
00:08:27,671 --> 00:08:31,996
public Text countText と入力します

186
00:08:32,925 --> 00:08:35,689
UI Text のText プロパティーの

187
00:08:35,689 --> 00:08:39,132
開始の値を設定する必要があります

188
00:08:39,756 --> 00:08:42,336
これも Start 内でできます

189
00:08:43,085 --> 00:08:54,482
countText.text = "Count: " + count.ToString () と入力します

190
00:08:55,351 --> 00:08:57,969
() は必要です

191
00:08:57,969 --> 00:08:59,969
このコードは count の値を設定した行の

192
00:08:59,969 --> 00:09:01,969
後に入力するよう

193
00:09:01,969 --> 00:09:03,969
気を付けてください　

194
00:09:03,969 --> 00:09:06,875
なぜなら count は text に

195
00:09:06,875 --> 00:09:08,875
必要な値を持っているからです

196
00:09:09,602 --> 00:09:11,602
新しいアイテムを取得したときはいつも

197
00:09:11,602 --> 00:09:13,602
この text プロパティーを

198
00:09:13,602 --> 00:09:15,061
更新しなければなりません

199
00:09:15,061 --> 00:09:17,061
そのため、OnTriggerEnter で

200
00:09:17,061 --> 00:09:19,267
count の値を増加した後に

201
00:09:19,267 --> 00:09:20,802
もう一度

202
00:09:20,802 --> 00:09:28,250
countText.Text = "Count: " + count.ToString () と入力します

203
00:09:29,989 --> 00:09:32,398
私たちは今までに、同じスクリプト内に

204
00:09:32,398 --> 00:09:34,398
2 回、同じコードを入力しました

205
00:09:35,030 --> 00:09:37,030
こういう形は一般的には良くありません

206
00:09:37,805 --> 00:09:39,805
これを少しすっきりさせるには

207
00:09:39,805 --> 00:09:41,805
ある場所で作業を行う関数を作っておき

208
00:09:41,805 --> 00:09:43,805
必要な時にいつでも

209
00:09:43,805 --> 00:09:45,805
この関数を

210
00:09:45,805 --> 00:09:47,470
呼び出す方法です

211
00:09:48,074 --> 00:09:50,074
では、SetCountText という

212
00:09:50,074 --> 00:09:52,074
新しい関数を作成しましょう

213
00:09:52,627 --> 00:09:56,551
void SetCountText と入力し

214
00:09:56,551 --> 00:09:58,946
その後に空の () と

215
00:09:59,689 --> 00:10:01,689
空の {} をつけます

216
00:10:02,701 --> 00:10:04,701
では、このコードの 1 つを

217
00:10:04,701 --> 00:10:06,701
カット＆ペーストで

218
00:10:06,701 --> 00:10:09,757
この関数に移しましょう

219
00:10:17,155 --> 00:10:19,155
そして、それがあった場所に

220
00:10:19,155 --> 00:10:22,287
作った関数を呼び出すコードを入力します

221
00:10:23,789 --> 00:10:25,789
最後に、もう 1 つの行も

222
00:10:25,789 --> 00:10:28,608
呼び出し関数に置き換えます

223
00:10:30,492 --> 00:10:32,492
保存して Unity に戻ります

224
00:10:36,096 --> 00:10:38,526
PlayerController スクリプトに

225
00:10:38,526 --> 00:10:40,526
新しいテキストプロパティーがあります

226
00:10:40,526 --> 00:10:42,526
CountTextゲームオブジェクトを

227
00:10:42,526 --> 00:10:46,558
このスロットに単にドラッグ & ドロップすることで

228
00:10:46,558 --> 00:10:49,177
Count Text への参照に

229
00:10:49,177 --> 00:10:51,177
関連付けできます

230
00:10:51,177 --> 00:10:53,177
Unity はゲームオブジェクトの 

231
00:10:53,177 --> 00:10:55,177
Text コンポーネントを探して

232
00:10:55,177 --> 00:10:57,177
正しく参照と関連付けします

233
00:10:57,904 --> 00:10:59,904
シーンを保存して再生しましょう

234
00:11:06,401 --> 00:11:09,291
いいですね。今ではオブジェクトを

235
00:11:09,291 --> 00:11:11,643
集めるだけでなく数えられるようになりました

236
00:11:13,461 --> 00:11:15,461
プレイモードを閉じましょう

237
00:11:15,461 --> 00:11:17,461
アイテムをすべて収集したときに

238
00:11:17,461 --> 00:11:19,701
メッセージを表示する必要があります

239
00:11:20,283 --> 00:11:22,283
そうするには、もう 1 つ 

240
00:11:22,283 --> 00:11:24,283
UI Text オブジェクトが必要です

241
00:11:24,283 --> 00:11:28,125
もう 1 度 Hierarchy の Create メニューを使って

242
00:11:28,125 --> 00:11:31,294
新しい UI Text ゲームオブジェクトを作ります

243
00:11:32,290 --> 00:11:34,498
それを WinText という名にします

244
00:11:37,865 --> 00:11:40,849
新しい UI Text エレメントがどのようにして

245
00:11:40,849 --> 00:11:43,743
自動的に Canvasに加えられたかに気を付けてください

246
00:11:43,743 --> 00:11:45,743
このテキストをゲーム空間の

247
00:11:45,743 --> 00:11:48,520
中央の少し上に表示します

248
00:11:48,520 --> 00:11:50,520
そうすれば Player ゲームオブジェクトを

249
00:11:50,520 --> 00:11:52,520
隠さずにすみます

250
00:11:53,200 --> 00:11:56,385
そうするには Rect Transform のPos Y エレメントを

251
00:11:56,385 --> 00:11:59,065
UI Text エレメントが デフォルトで

252
00:11:59,065 --> 00:12:01,065
canvas の中央にアンカーされるよう

253
00:12:01,065 --> 00:12:03,065
調整しましょう

254
00:12:08,518 --> 00:12:12,029
75 あたりが適切なようです

255
00:12:13,948 --> 00:12:15,948
Text コンポーネントの 

256
00:12:15,948 --> 00:12:17,948
Paragraph のAlignment も

257
00:12:18,438 --> 00:12:20,438
調整しましょう

258
00:12:21,876 --> 00:12:23,956
次に、色を調整して

259
00:12:24,651 --> 00:12:26,651
以前の Text エレメントに使用した

260
00:12:26,651 --> 00:12:29,321
黄色に設定します

261
00:12:30,538 --> 00:12:33,159
フォントサイズを 24 にして

262
00:12:33,159 --> 00:12:36,029
テキストを少し大きくしましょう

263
00:12:36,819 --> 00:12:39,915
最後に、プレースホルダーのテキストを加え

264
00:12:39,915 --> 00:12:42,472
文字列 New Text を Win Text　に

265
00:12:42,472 --> 00:12:44,472
置き換えましょう

266
00:12:45,910 --> 00:12:47,910
シーンを保存して

267
00:12:47,910 --> 00:12:49,910
スクリプトエディターに戻りましょう

268
00:12:52,818 --> 00:12:54,818
この UI Text エレメントの参照を

269
00:12:54,818 --> 00:12:56,818
加える必要があります

270
00:12:56,818 --> 00:12:58,818
新しいパブリックの Text の変数を作り 

271
00:12:58,818 --> 00:13:01,621
WinText と呼びましょう

272
00:13:03,316 --> 00:13:07,286
public Text winText と入力します

273
00:13:09,120 --> 00:13:11,831
WinText の text プロパティーの

274
00:13:11,831 --> 00:13:14,420
最初の値を設定します

275
00:13:15,179 --> 00:13:17,751
これは空の文字列にするか

276
00:13:17,751 --> 00:13:19,751
何も中に入ってない 

277
00:13:19,751 --> 00:13:21,879
“” マークにします

278
00:13:21,879 --> 00:13:24,644
この Text プロパティーは空で始まります

279
00:13:24,644 --> 00:13:27,896
それから、SetCountText 関数に

280
00:13:27,896 --> 00:13:34,553
以下を入力します。「count が 12 より大きい、または等しければ、」

281
00:13:35,090 --> 00:13:37,090
12 はゲーム内で収集できる

282
00:13:37,090 --> 00:13:39,090
オブジェクトの総数です

283
00:13:39,090 --> 00:13:42,621
「winText.Text は

284
00:13:42,621 --> 00:13:44,621
You win! に等しい」

285
00:13:45,822 --> 00:13:53,189
If (count >= 12)  

286
00:13:57,788 --> 00:14:02,284
winText.Text = “YouWin!”; と入力します

287
00:14:04,861 --> 00:14:07,337
このスクリプトを保存して Unity に戻ります

288
00:14:12,046 --> 00:14:14,379
ここでも Player 上の Player Controllerに

289
00:14:14,379 --> 00:14:17,320
新しい UI Text プロパティーが表示されています

290
00:14:17,936 --> 00:14:19,936
ここでもまた、WinText ゲームオブジェクトを

291
00:14:19,936 --> 00:14:21,936
新しいスロットにドラッグして

292
00:14:21,936 --> 00:14:24,428
コンポーネントの関連付けができます

293
00:14:25,723 --> 00:14:27,550
シーンを保存して再生しましょう

294
00:14:34,774 --> 00:14:36,774
ゲームオブジェクトを収集して

295
00:14:36,774 --> 00:14:38,774
それを数え

296
00:14:38,774 --> 00:14:40,250
勝ちました！

297
00:14:40,250 --> 00:14:42,250
さらに、12 のオブジェクトを全部集めると

298
00:14:42,250 --> 00:14:46,024
「You Win!」(勝利！) のテキストが表示されます

299
00:14:46,830 --> 00:14:48,830
次回このシリーズ最後のレッスンでは

300
00:14:48,830 --> 00:14:50,830
スタンドアロンプレイヤーを使って

301
00:14:50,830 --> 00:14:52,830
ゲームをビルドして

302
00:14:52,830 --> 00:14:55,052
デプロイします
